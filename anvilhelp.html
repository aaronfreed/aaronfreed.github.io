<!DOCTYPE html>
<html lang="en-us">
	<head>
		<meta charset="UTF-8">
		<title>The Annotated Anvil Help Balloons (with amendments, addenda, and asides for ShapeFusion)</title>
		<link rel="stylesheet" type="text/css" href="https://code.cdn.mozilla.net/fonts/fira.css">
		<link rel="stylesheet" type="text/css" href="css.css">
		<script>
function sortTable(table, col, reverse) {
	var tb = table.tBodies[0], // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
		tr = Array.prototype.slice.call(tb.rows, 0), // put rows into array
		i;
	reverse = -((+reverse) || -1);
	tr = tr.sort(function (a, b) { // sort rows
		return reverse // `-1 *` if want opposite order
			* (a.cells[col].textContent.trim() // using `.textContent.trim()` for test
				.localeCompare(b.cells[col].textContent.trim(), undefined, {numeric: true})
			);
	});
	for(i = 0; i < tr.length; ++i) tb.appendChild(tr[i]); // append each row in order
}

function makeSortable(table) {
	var th = table.tHead, i;
	th && (th = th.rows[0]) && (th = th.cells);
	if (th) i = th.length;
	else return; // if no `<thead>` then do nothing
	while (--i >= 0) (function (i) {
		var dir = 1;
		th[i].addEventListener('click', function () {sortTable(table, i, (dir = 1 - dir))});
	}(i));
}

function makeAllSortable(parent) {
	parent = parent || document.body;
	var t = parent.getElementsByTagName('table'), i = t.length;
	while (--i >= 0) makeSortable(t[i]);
}

window.onload = function () {makeAllSortable();};
		</script>
	</head>
	<body class="light fixheight">

		<header>
			<h1 id="anvilhelp" class="petitecaps centred" style="margin-bottom: 4px;"><em>Marathon</em>: The Annotated Anvil Help Balloons</h1>
			<h4 class="centred">(how to edit physics, shapes, &amp; sounds files, with amendments, addenda, &amp; asides for ShapeFusion)</h4>

			<p>This page reproduces, <span id="ftnt_ref01" class="dotted" title="Well, almost. I&apos;ve omitted what appear to be &lsquo;dummy balloons&rsquo; referring to features that weren&apos;t implemented in Anvil and don&apos;t appear in ShapeFusion either. Some of these seem to be documentation of M1-specific features. Others may have been documentation for features included in development releases of Anvil that Bungie thought better of including in the finished product; not having been a Bungie employee circa 1996, I can&apos;t say for sure.">in its entirety,<a href="#ftnt01" class="noprintlink">&#8317;&sup1;&#8318;</a></span> Bungie&rsquo;s in-program help for Anvil, their official utility for editing <em>Mara&shy;thon Infinity</em> physics, shapes, and sounds files. Nearly all of this is also applicable to the modern replacement <a href="https://github.com/treellama/shapefusion/releases" target="_blank">ShapeFusion</a>, which does not include any of this information. I&rsquo;ve formatted it with occasional asides and corrections, which I&rsquo;ve marked in <em>[bracketed italics]</em>, with <em>-Ed.</em> preceding the closing bracket.</p>

			<p>The Anvil help balloons, collectively, make up one of three major Anvil features I&rsquo;m aware of that ShapeFusion does not currently replicate. The other two are:</p>

			<ol start="2">
				<li>The ability to create a new <em>Marathon Infinity</em> physics model &ndash; the &quot;<em>Marathon Infinity</em>&quot; physics model included with <em>Marathon Infinity</em> is actually a <em>Marathon 2</em> physics model. The <em>actual</em> physics for <em>Marathon Infinity</em> are available <a href="https://simplici7y.com/items/default-infinity-physics-model-2/" target="_blank">on Simplici7y</a>.</li>
				<li>&quot;Clone into Collection&quot; for Shapes files. See the relevant section at the end of this very document for ways to approximate this. (Advance warning: They both require a fair bit of tech savvy. Sorry.)</li>
			</ol>

			<p>I&rsquo;ve made annotations correcting errors in the original help balloons and noting where and how ShapeFusion&apos;s behavior differs from Anvil&rsquo;s. Please <a href="aboutme.html">contact me</a> if you notice any errors or omissions.</p>

			<p>My <a href="mapmaking101.html">beginners&rsquo; mapmaking page</a> and <a href="mapmaking.html">advanced mapmaking page</a> may provide more context for much of this.</p>

			<h1 id="contents">Table of Contents</h1>
			<ol class="toclite">
				<li><a href="#physicsmodels">Physics Models</a>
					<ol>
						<li><a href="#anvilaliens">Aliens</a>
							<ol>
								<li><a href="#alienappearance">Appearance and Sounds</a></li>
								<li><a href="#aliencombat">Combat Settings</a></li>
								<li><a href="#alienphysics">Physical Constants</a></li>
								<li><a href="#alienbehavior">Behavior Settings</a></li>
								<li><a href="#alienimmunities">Immunities and Weaknesses</a></li>
							</ol>
						</li>
						<li><a href="#anvileffects">Effects</a></li>
						<li><a href="#anvilshots">Shots</a></li>
						<li><a href="#anvilphysics">Physics</a></li>
						<li><a href="#anvilweapons">Weapons</a>
							<ol>
								<li><a href="#weapondefinition">Weapon Definition</a></li>
								<li><a href="#triggersettings">Trigger Settings</a></li>
							</ol>
						</li>
					</ol>
				</li>
				<li><a href="#anvilsounds">Sounds</a></li>
				<li><a href="#anvilshapes">Shapes</a>
					<ol>
						<li><a href="#anvilbitmaps">Bitmaps and Color Tables</a></li>
						<li><a href="#anvilsequences">Frames and Sequences</a>
							<ol>
								<li><a href="#sequences">Sequences</a></li>
								<li><a href="#frames">Frames</a></li>
							</ol>
						</li>
						<li><a href="#clone">Clone into Collection</a> <em class="light">(not currently implemented in ShapeFusion)</em></li>
					</ol>
				</li>
				<li><a href="#endnotes">Endnotes</a></li>
			</ol>

		</header>
		<main>
			<ol class="nestednumbering">
				<li><h1 id="physicsmodels">Physics Models</h1>
					<ol>
						<li><h2 id="anvilaliens">Aliens</h2>
						The &quot;Aliens&quot; section of the physics model stores information about all of the moving, thinking, and attacking objects in the game, such as monsters and BOBs.
							<ol>
								<li><h3 id="alienappearance">Appearance and Sounds</h3>
									<ul>
										<li><strong>Appearance:</strong> The appearance of a character is determined by a graphic collection index, a color table index, and a list of sequence IDs. Select each edit field for more information.
											<ul>
												<li><strong>Graphic Collection:</strong> The Graphic Collection must be a number between 0 and 31. It indicates which collection of graphics in the Shapes file will be used to draw this character. To preview the graphics collections, open a Shapes file.</li>
												<li><strong>Color Table:</strong> The Color Table must be a number between 0 and the number of tables defined for this collection. It indicates which collection of colors will be used to draw this character. To preview the color tables and graphics, open a Shapes file.</li>
												<li><strong>Sequence IDs:</strong> Each type of character behavior may have a unique Sequence ID to describe the animation that Marathon should play during the character&apos;s action. To preview Sequences, open a Shapes file.
													<ul>
														<li><strong>Hit:</strong> This animation sequence will be played whenever the character takes damage from a projectile. To not display any animation when the character is hit, enter &minus;1.</li>
														<li><strong>Hard Dying:</strong> This animation sequence will be played whenever the character&apos;s vitality falls below 0 due to massive, or explosive, damage. When it completes, the character will become &quot;Dead.&quot; To not display a Dying animation, enter &minus;1.</li>
														<li><strong>Soft Dying:</strong> This animation sequence will be played whenever the character&apos;s vitality falls below 0 due to non-explosive damage. When it completes, the character will become &quot;Dead.&quot; To not display a Dying animation, enter &minus;1.</li>
														<li><strong>Hard Dead:</strong> This animation sequence (which typically has only one frame) will be displayed at the location where the character dies (due to massive, or explosive, damage) until the level is cleared. If the character disappears when it dies, enter &minus;1.</li>
														<li><strong>Soft Dead:</strong> This animation sequence (which typically has only one frame) will be displayed at the location where the character dies (due to non-explosive damage) until the level is cleared. If the character disappears when it dies, enter &minus;1.</li>
														<li><strong>Stationary:</strong> This sequence will be played whenever the character remains stationary. You may not enter a &minus;1 here.</li>
														<li><strong>Moving:</strong> This sequence will be played whenever the character moves. You may not enter a &minus;1 here.</li>
														<li><strong>Teleport In:</strong> This sequence will be played during the teleport-in action of the character. Marathon will add a teleport-in visual effect to the sequence.</li>
														<li><strong>Teleport Out:</strong> This sequence will be played during the teleport-out action of the character. Marathon will add a teleport-out visual effect to the sequence.</li>
													</ul>
												</li>
											</ul>
										</li>
										<li><strong>Sounds:</strong> Not all of the sounds related to a character are stored in the Physics Model; each sequence may optionally contain up to three other sounds. To edit these sounds, open a Shapes file.
											<ul>
												<li><strong>Activation:</strong> This sound will be played whenever the character becomes active.</li>
												<li><strong>Friendly Activation:</strong> This sound will be played when a character friendly to the player decides that the player is no longer friendly and should become dogmeat. <em>[This can also apply if the character turns on a non-player - for instance, a monster marked as Berserker will play this when it goes berserk, regardless of whether it turned on the player specifically. -Ed.]</em></li>
												<li><strong>Clear:</strong> This sound is played when a character can find no more enemies in range. <em>[But only if they are set to teleport out. -Ed.]</em></li>
												<li><strong>Kill:</strong> This sound is played when a character kills a target.</li>
												<li><strong>Apology:</strong> This sound is played when a character&apos;s projectile hits the player.</li>
												<li><strong>Friendly Fire:</strong> This sound is played when one of the player&apos;s projectiles <em>[hits -Ed.]</em> the character.</li>
												<li><strong>Flaming:</strong> This sound is played when the character dies from damage of type &quot;Flame.&quot;</li>
												<li><strong>Random:</strong> This sound will be played at random times depending on the random sound mask, below.</li>
												<li><strong>Random Sound Mask:</strong> This value determines how often the character will play its random sound. It is a value between 0 and 31 where each unique power of 2 increases the chance of playing the sound (so linearly increasing probabilities are 1,3,7,15,31)</li>
												<li><strong>Sound Pitch:</strong> This value will pitch every sound played by the character. Enter 1.0 for normal playback, higher values for higher pitches, and lower values (greater than 0.0) for lower pitches.</li>
											</ul>
										</li>
									</ul>
								<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>	
								<li><h3 id="aliencombat">Combat Settings</h3>
									<ul>
										<li><strong>Attack Frequency:</strong> The attack frequency indicates how often the character will launch an attack (but not how many projectiles will be fired during that attack). The value measures the number of ticks between attacks (where 1 tick = 1/30th of a second).</li>
										<li><strong>Melee Attack:</strong> The character will use its melee attack if it is within the melee attack range of the character and a melee attack exists (note that if the Chooses Weapon Randomly flag is checked the character will choose an attack at random).</li>
										<li><strong>Ranged Attack:</strong> The character will use its ranged attack if it is not within the melee attack range of the character and a ranged attack exists (note that if the Chooses Weapon Randomly flag is checked the character will choose an attack at random).
											<ul>
												<li><strong>Type:</strong> The attack type corresponds to a projectile type (see the Shots section of the model) which will be created when the character attacks.</li>
												<li><strong>Repetitions:</strong> When the attack is launched, the character will create a number of projectiles equal to the attack repetitions value. <em>[This varies depending on difficulty setting, as <a href="https://github.com/Aleph-One-Marathon/alephone/wiki/Changes-Based-on-Difficulty">the Aleph One GitHub wiki</a> explains; the number of repetitions is halved on Kindergarten and Easy and reduced by one on Normal. Characters&apos; alignment and the &quot;Alien&quot; setting appear to have no effect on this behavior. -Ed.]</em></li>
												<li><strong>Error:</strong> The attack error will be added randomly in plus or minus degrees (out of 512) to each attack launched by the character.</li>
												<li><strong>Range:</strong> The attack range is the maximum range at which the character will launch the attack, not the maximum range that the projectile may travel (the projectile&apos;s maximum range is determined by the projectile record; see the Shots section).</li>
												<li><strong>Sequence ID:</strong> This sequence will be played during the character&apos;s attack; note that this sequence is also where the sound played during the attack is referenced. To review sequences, open a Shapes file.</li>
												<li><strong>dx:</strong> The dx value will be added to the character&apos;s current position in the x-direction (left-to-right) to find the starting location of the attack projectile. <em>[As far as I can ascertain, this is incorrect, and the descriptions and labels for &quot;dx&quot; and &quot;dy&quot; should be swapped. -Ed.]</em></li>
												<li><strong>dy:</strong> The dy value will be added to the character&apos;s current position in the y-direction (front-to-back) to find the starting location of the attack projectile. <em>[As far as I can ascertain, this is incorrect, and the descriptions and labels for &quot;dx&quot; and &quot;dy&quot; should be swapped. -Ed.]</em></li>
												<li><strong>dz:</strong> The dz value will be added to the character&apos;s current position in the z-direction (top-to-bottom) to find the starting location of the attack projectile.</li>
											</ul>
										</li>
										<li><strong>Shrapnel:</strong> If a shrapnel radius and shrapnel type are provided, the character will inflict damage on nearby characters when it dies.
											<ul>
												<li><strong>Shrapnel Radius:</strong> The shrapnel radius acts like the area of effect of a projectile. Every character within the radius of the character when it dies will suffer the damage described below.</li>
												<li><strong>Damage Type:</strong> The damage type must be specified so that immunities and weaknesses can be applied to whatever the shrapnel hits. To change immunities and weaknesses, edit the Monsters section of the model.</li>
												<li><strong>Alien Damage:</strong> If the shrapnel damage is inflicted by the aliens, Marathon needs to know so that it can make the Kindergarten and Easy levels easier, and the Major Damage and Total Carnage levels harder. <em>[The latter part of this is incorrect &ndash; Alien damage does not increase above Normal. -Ed.]</em></li>
												<li><strong>Base Damage:</strong> The damage base is the minimum amount of damage that will be applied to the target. A random amount between 0 and the damage random (below) will also be applied.</li>
												<li><strong>Random Damage:</strong> The damage base (above) is the minimum amount of damage that will be applied to the target. A random amount between 0 and the damage random will also be applied. <em>[As far as I can tell, the game actually adds a random number from 0 to (damage random - 1), inclusive, to the base damage; if damage random is 0, then it just ignores the field. -Ed.]</em></li>
												<li><strong>Scale:</strong> The shrapnel damage scale should always be 1.0000, if shrapnel is desired.</li>
											</ul>
										</li>
										<li><strong>Impact Effects:</strong> Impact effects are played when the character suffers damage from a projectile. The melee impact effect is used only for projectiles that have the &apos;melee&apos; flag set.
											<ul>
												<li><strong>Ranged:</strong> When the character is hit by a ranged projectile (that is, any projectile that does not have the &apos;melee&apos; flag set), this effect, if one is specified, will be played.</li>
												<li><strong>Melee:</strong> When the character is hit by a melee projectile (that is, any projectile that has the &apos;melee&apos; flag set), this effect, if one is specified, will be played.</li>
											</ul>
										</li>
									</ul>
								<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>	
								<li><h3 id="alienphysics">Physical Constants</h3>
									<ul>
										<li><strong>Vitality:</strong> The vitality of the character measures how much damage it can endure before dying. Any projectile, polygon effect, or shrapnel effect that causes damage to the character decreases this value.</li>
										<li><strong>Radius:</strong> The radius of the character measures how narrow a gap in the map it can pass through and need not match the radius of the graphic used to draw it.</li>
										<li><strong>Height:</strong> The height of the character measures how short a window in the map it can pass through and need not match the height of the graphic used to draw.</li>
										<li><strong>Movement:</strong> The constants in this section determine how the character moves around the map.
											<ul>
												<li><strong>Speed:</strong> Characters always move at the same speed <em>[on the same difficulty setting if their &quot;Alien&quot; flag is set; on any difficulty setting if it isn&apos;t -Ed.]</em>. Note that to translate a player speed (as in a Physics record) to a character speed, multiply by 512.</li>
												<li><strong>Terminal Velocity:</strong> The terminal velocity measures the maximum rate at which the character can move through space, as when falling.</li>
												<li><strong>Gravity:</strong> The gravity field measures how quickly the character will fall when it is no longer suspended by its own motion.</li>
												<li><strong>Min. Ledge Jump:</strong> The minimum ledge jump measures the largest downwards jump that the character will take willingly.</li>
												<li><strong>Max. Ledge Jump:</strong> The maximum ledge jump measures the large upwards jump that the character can make.</li>
												<li><strong>External Velocity Scale:</strong> The external velocity scale acts like inertial mass to determine how objects behave near explosions. 0.0 will cause objects to remain at rest after explosions, while 1.0 will make them act like fighters.</li>
												<li><strong>Hover Height:</strong> If the &quot;Hovers&quot; flag is set (see Behavior Constants), the character will hover at this height when moving.</li>
												<li><strong>Door Retry Mask:</strong> This field determines how often the character will attempt to open doors. It is a value between 0 and 31 where each unique power of 2 increases the chance of playing the sound (so linearly increasing probabilities are 1,3,7,15,31)</li>
											</ul>
										</li>
										<li><strong>Perception:</strong> The constants in this section determine how well the character can detect and track other characters on the map.
											<ul>
												<li><strong>Visual Range:</strong> The visual range is maximum range at which the character can become aware of another character&apos;s presence on the map, assuming that the intervening polygons are lit. <em>[As far as I can tell, this is incorrect: its dependent clause should be struck and replaced with &quot;if the character is not invisible.&quot; -Ed.]</em></li>
												<li><strong>Dark Visual Range:</strong> The dark visual range is maximum range at which the character can become aware of another characters presence on the map, if the intervening polygons are not lit. <em>[As far as I can tell, this is also incorrect: its dependent clause should be struck and replaced with &quot;if the character is invisible&quot;, just in case that wasn&apos;t already obvious from my previous note. -Ed.]</em></li>
												<li><strong>Intelligence:</strong> Intelligence measures the maximum number of polygons through which the character &quot;keep a lock&quot; on an enemy character and continue to follow and attack it. <em>[Setting this above 8 seems to cause some serious issues. Don&apos;t do it. -Ed.]</em></li>
											</ul>
										</li>

										<li><strong>Carrying Item Type:</strong> When the character dies, if the damage that caused the death was not of type Explosion or Flame, it will create one of the items specified here.</li>
										<li><strong>Contrail Effect:</strong> The contrail effect, if one is specified, will be played at periodical intervals whenever the character is moving. <em>[As far as I can tell, this too is incorrect: its dependent clause should be struck and replaced with &quot;whenever the character is dying, if the &apos;delayed hard death&apos; flag is set&quot;. -Ed.]</em></li>
									</ul>
								<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>	
								<li><h3 id="alienbehavior">Behavior Settings</h3>
									<ul>
										<li><strong>Class:</strong> Every character has a &quot;Class&quot; which is used to determine friend and enemy relationships between the character and the other targets on the map.</li>
										<li><strong>Friends:</strong> Any character class that is checked here will be treated as a &quot;Friend.&quot; The character will not attack friends and will not attack a friend that accidentally hits it.</li>
										<li><strong>Enemies:</strong> Any character class that is checked here will be treated as an &quot;Enemy.&quot; The character will immediately attack enemies and will move to decrease the range to any enemy that it is aware of.</li>
										<li><strong>Flags:</strong> The flags are used to activate a range of useful and interesting behaviors on each character. Some of them require additional numeric fields to be set.
											<ul>
												<!--<li>The omniscient flag is used internally by Marathon. You cannot change its value. <em>[I have never seen this flag, but it&apos;s in the help strings, so I listed it here. -Ed.]</em></li>-->
												<li><strong>Flies:</strong> If this flag is set, the character can change its height at will instead of staying on the floor.</li>
												<li><strong>Is Alien:</strong> If this flag is set, Marathon will make this monster tougher on hard difficulty settings and wimpier on easy difficulty settings. <em>[The Aleph One wiki has a <a href="https://github.com/Aleph-One-Marathon/alephone/wiki/Changes-Based-on-Difficulty" target="_blank">complete list of changes</a>. -Ed.]</em></li>
												<li><strong>Major:</strong> Each monster may have a Major and a Minor variant, which Marathon will choose between in order to make a level harder or easier. If this flag is set, the monster is a Major variant.</li>
												<li><strong>Minor:</strong> Each monster may have a Major and a Minor variant, which Marathon will choose between in order to make a level harder or easier. If this flag is set, the monster is a Minor variant.</li>
												<li><strong>Cannot Skip:</strong> To make a level easier, Marathon will sometimes &quot;skip&quot; a character (remove it from the level). If the character should never be skipped (i.e. necessary civilians), check this.</li>
												<li><strong>Floats:</strong> If this flag is set, the character will float at its &quot;hover height&quot; (see Physical Constants) above the floor.</li>
												<li><strong>Cannot Attack:</strong> If this flag is set, the character cannot launch any attacks. <em>[This is incorrect: they can attack, but only sporadically and haphazardly. The &quot;disabled juggernauts&quot; found in <em ><a href="https://eternal.bungie.org/" target="_blank">Eternal</a></em>&apos;s &quot;Second to Last of the Mohicans&quot; (starting in 1.2) and &quot;Killing the Giants as They Sleep&quot; (starting in 1.3 preview 5) provide examples of this. -Ed.]</em></li>
												<li><strong>Uses Sniper Ledges:</strong> If this flag is set, the character will stay on a ledge that provides a good vantage point instead of charging into combat with an enemy.</li>
												<li><strong>Chooses Weapon Randomly:</strong> If this flag is set, the character will choose between its melee and ranged attack randomly instead of consulting the range to the target.</li>
												<li><strong>Invisible:</strong> If this flag is set, the character will be drawn in a darker shade of its background, making it much harder to see. The amount of invisibility will be equivalent to a Marine with one Invisibility powerup.</li>
												<li><strong>Subtly Invisible:</strong> If this flag is set, the character will be drawn in almost exactly the same color as its background. The amount of invisibility will be equivalent to a Marine with 2 Invisibility powerups.</li>
												<li><strong>Kamikaze:</strong> If this flag is set, the character will always attempt to move closer to an enemy and will explode (inflict shrapnel damage) when it reaches one.</li>
												<li><strong>Berserker:</strong> If this flag is set, the character will move and attack with greater speed and ferocity when it is nearly dead. <em>[It will also attack anything around it, regardless of whether it would ordinarily consider said monsters allies or not. -Ed.]</em></li>
												<li><strong>Enlarged:</strong> If this flag is set, the character will be drawn at 125% of its normal size.</li>
												<li><strong>Delayed Hard Death:</strong> If this flag is set, the character will not play its hard death sequence until it reaches the ground. <em>[This means that it will play the Soft Dying sequence until it reaches the ground, then the Hard Dying sequence when it hits the ground. Its corpse will use the Hard Dead sequence. -Ed.]</em></li>
												<li><strong>Fires Symmetrically:</strong> If this flag is set, the character will create two projectiles for each attack, symmetrically oriented on either side of its body.</li>
												<li><strong>Nuclear Hard Death:</strong> If this flag is set, the character will create a special &quot;nuclear explosion&quot; effect when it hits the ground.</li>
												<li><strong>Can&apos;t Fire Backwards:</strong> If this flag is set, the character cannot spin 180 degrees, fire, and then turn back again (it looks bad for big enemies).</li>
												<li><strong>Die in Flames:</strong> If this flag is set, the character will use the special &quot;dying in flames&quot; sequence indicated in the Appearance section if it dies due to Flame damage.</li>
												<li><strong>Stay with Clear Shot:</strong> If this flag is set, the character will remain stationary and continue firing instead of moving closer to a target when it has a clear shot.</li>
												<li><strong>Tiny:</strong> If this flag is set, the character will be drawn at 25% of its normal size.</li>
												<li><strong>Attacks Immediately:</strong> If this flag is set, the character will attack as soon as it teleports into the level rather than waiting for its normal attack delay.</li>
												<li><strong>Not Afraid of Water:</strong> If this flag is set, the character will enter water polygons as though they were clear.</li>
												<li><strong>Not Afraid of Sewage:</strong> If this flag is set, the character will enter sewage polygons as though they were clear.</li>
												<li><strong>Not Afraid of Lava:</strong> If this flag is set, the character will enter lava polygons as though they were clear.</li>
												<li><strong>Not Afraid of Goo:</strong> If this flag is set, the character will enter goo polygons as though they were clear.</li>
												<li><strong>Can Teleport Under Liquid:</strong> If this flag is set, the character will be able to teleport into <em>[or out of -Ed.]</em> the game underneath any kind of media. <em>[Note also that, if this flag isn&apos;t set and the character would be called on to teleport in underneath a liquid (e.g., a player walks on an Invisible or Dual Monster Trigger polygon within the same zone), the character will never teleport in, even if they&apos;re again called on to activate after the liquid is lowered. -Ed.]</em></li>
											</ul>
										</li>
									</ul>
								<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>	
								<li><h3 id="alienimmunities">Immunities and Weaknesses</h3>
									<ul>
										<li><strong>Immunities:</strong> If a character is marked &quot;Immune&quot; to a type of damage, it will suffer no loss of vitality when it is hit by a projectile or shrapnel effect inflicting that class of damage. <em>[It will also not get angry at any monster or player that hits it with said damage type. -Ed.]</em></li>
										<li><strong>Weaknesses:</strong> If a character is marked &quot;Weak&quot; to a type of damage, it will suffer a much greater loss of vitality when it is hit by a projectile or shrapnel effect inflicting that class of damage. <em>[Specifically, twice as much. Also, in </em>Marathon 2<em> and </em>Marathon Infinity<em>, if a monster dies to one of its weaknesses, it undergoes its hard death sequence unless &quot;<strong>(M1) Weaknesses Cause Soft Death</strong>&quot; is checked under &quot;<strong>Behavior Settings</strong>&quot;. -Ed.]</em></li>
										<li><strong>Explosion:</strong> Explosion damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Electrical Staff:</strong> Pfhor staff damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Projectile:</strong> Projectile damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Absorbed:</strong> Absorbed damage is specified by the Damage Type field of a projectile or shrapnel effect, or whenever the player takes damage while using an invulnerability powerup.</li>
										<li><strong>Flame:</strong> Flame damage is specified by the Damage Type field of a projectile or shrapnel effect. It also may trigger the special &quot;dying in flames&quot; sequence.</li>
										<li><strong>Claws:</strong> Claws damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Alien Projectile:</strong> Alien Projectile damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Hulk Slap:</strong> Hulk Slap damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Compiler Bolt:</strong> S&apos;pht Bolt damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Fusion Bolt:</strong> Fusion bolt damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Hunter Bolt:</strong> Hunter bolt damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Fist:</strong> Fist damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Teleporter:</strong> Teleporter damage is specified by the Damage Type field of a projectile or shrapnel effect, or whenever a character teleports into the same space occupied by another character.</li>
										<li><strong>S&apos;pht&apos;Kr Bolt:</strong> S&apos;pht&apos;Kr damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>F&apos;lickta Claws:</strong> Flick&apos;ta <em>[sic -Ed.]</em> claws damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>F&apos;lickta Projectile:</strong> Flick&apos;ta <em>[sic -Ed.]</em> glob damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Crushing:</strong> Crushing damage is specified by the Damage Type field of a projectile or shrapnel effect, or by any map polygon that reduces the height of the polygon to less than the character&apos;s height.</li>
										<li><strong>Lava:</strong> Lava damage is specified by the Damage Type field of a projectile or shrapnel effect, or by a Lava map polygon <em>[more precisely, either by lava or by a Minor Ouch polygon, unless these have been customized using MML -Ed.]</em>.</li>
										<li><strong>Suffocation:</strong> Suffocation damage is specified by the Damage Type field of a projectile or shrapnel effect, or whenever the player runs out of oxygen.</li>
										<li><strong>Goo:</strong> Goo explosion damage is specified by the Damage Type field of a projectile or shrapnel effect, or by a Goo map polygon <em>[more precisely, either by goo or by a Major Ouch polygon, unless these have been customized using MML -Ed.]</em>.</li>
										<li><strong>Energy Drain:</strong> Energy Drain damage is specified by the Damage Type field of a projectile or shrapnel effect. <em>[Damage of this type can strip a player&apos;s shields to 0, but it cannot actually kill them. -Ed.]</em></li>
										<li><strong>Oxygen Drain:</strong> Oxygen Drain damage is specified by the Damage Type field of a projectile or shrapnel effect. <em>[Damage of this type can strip a player&apos;s oxygen to 0, but it cannot actually kill them. If you need to kill a player once their oxygen would fall below 0, make sure to include Lua code along these lines:
		<pre>function Triggers.player_damaged(p, aggressor_player, aggressor_monster,
damage_type, damage_amount, projectile)
    -- manually kill player if oxygen drain should reduce oxygen below 0
    if damage_type == &quot;oxygen drain&quot; then
        if p._previous_oxygen ~= nil
        and p._previous_oxygen - damage_amount &lt; 0 then
            -- remove invincibility (i.e., immunity to suffocation)
            p.invincibility_duration = 0 
            p:damage(p.life + 1, &quot;suffocation&quot;)
        end
        p._previous_oxygen = p.oxygen -- track player oxygen
    end
end

function Triggers.postidle()
    for p in Players() do
        -- track oxygen for Triggers.player_damaged - otherwise, can&apos;t
        -- know what their oxygen levels were before oxygen drain damage
        p._previous_oxygen = p.oxygen
    end
end</pre>
										If you already have <code>Triggers.player_damaged</code> or <code>Triggers.postidle</code> functions, make sure to rename variables as needed and integrate the above code into said functions. Additionally, if you directly edit players&apos; oxygen values in any of your Lua scripts, you may need to implement similar code for those as well. -Ed.]</em></li>
										<li><strong>Drone Bolt:</strong> Drone Bolt damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
										<li><strong>Shotgun:</strong> Shotgun damage is specified by the Damage Type field of a projectile or shrapnel effect.</li>
									</ul>
								</li>
							</ol>
						<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>	
						<li><h2 id="anvileffects">Effects</h2>
						The &quot;Effects&quot; section of the physics model stores information about small animated effects, such as explosions and splashes.
							<ul>
								<li><strong>Graphic Collection:</strong> The Graphic Collection must be a number between 0 and 31. It indicates which collection of graphics in the Shapes file will be used to draw this effect. To preview the graphics collections, open a Shapes file.</li>
								<li><strong>Color Table:</strong> The Color Table must be a number between 0 and the number of tables defined for this collection. It indicates which collection of colors will be used to draw this effect. To preview the color tables and graphics, open a Shapes file.</li>
								<li><strong>Sequence:</strong> The sequence specified here will be played from the specified graphic collection using the specified color table.</li>
								<li><strong>Sound Pitch:</strong> The sounds referenced by the effect&apos;s graphic sequence can be scaled up or down by adjusting the sound pitch, here. Choose values greater than 1.0 for high-pitched sounds, or less than 1.0 (but greater than 0.0) for low-pitched sounds.</li>
								<li><strong>Delay:</strong> The delay field is used internally by Marathon. You cannot change its value.</li>
								<li><strong>Delay Sound:</strong> If a delay is specified, you may also specify a delay sound which will be played during the delay.</li>
								<li><strong>End when animation loops:</strong> This box should nearly always be checked. If it is, when the effect&apos;s sequence reaches its loop frame, the effect will end. If this box is not checked the sequence will loop indefinitely.</li>
								<li><strong>End when transfer animation loops:</strong> If a special transfer animation is used for the effect (i.e. teleport effects), this box has the same effect as the &quot;end when animation loops&quot; box, above.</li>
								<li><strong>Sound Only:</strong> If this box is checked, the effect will not create any visual sequence but will instead only play the sounds associated with the sequence. Note that the effect automatically ends when the sound is played.</li>
								<li><strong>Media effect:</strong> This box must be checked if the effect is a &quot;media effect&quot;, that is, an impact effect used when a projectile hits a media polygon layer (like a pool of water).</li>
								<!-- This flag is used internally by Marathon. You should not change it. -->
							</ul>
						<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>	
						<li><h2 id="anvilshots">Shots</h2>
						The &quot;Shots&quot; section of the physics model stores information about objects that are fired by weapons or monsters and that travel until they hit a target.
							<ul>
								<li><strong>Graphic Collection:</strong> The Graphic Collection must be a number between 0 and 31. It indicates which collection of graphics in the Shapes file will be used to draw this projectile. Note that 31 is used as a special value for &quot;no graphics&quot;.</li>
								<li><strong>Color Table:</strong> The Color Table must be a number between 0 and the number of tables defined for this collection. It indicates which collection of colors will be used to draw this projectile. Note that if no graphic is to appear you should enter the value 7.</li>
								<li><strong>Sequence ID:</strong> The Sequence ID must be the number of a sequence in the graphic collection specified above. It determines which sequence will be used to draw the projectile. To preview sequences, open a Shapes file.</li>
								<li><strong>Damage:</strong> The damage specified here will be applied to whatever target the projectile hits.</li>
								<li><strong>Damage Type:</strong> The damage type must be specified so that immunities and weaknesses can be applied to whatever the projectile hits. The damage type is also used to determine the &quot;screen flash&quot; effect when a player is hit. <em>[The flash associated with a particular damage type can be customized using MML. -Ed.]</em></li>
								<li><strong>Damage Base:</strong> The damage base is the minimum amount of damage that will be applied to the target. A random amount between 0 and the damage random (below) will also be applied.</li>
								<li><strong>Damage Random:</strong> The damage base (above) is the minimum amount of damage that will be applied to the target. A random amount between 0 and the damage random will also be applied. <em>[As far as I can tell, the game actually adds a random number from 0 to (damage random &minus; 1), inclusive, to the base damage; if damage random is 0, then it just ignores the field. -Ed.]</em></li>
								<li><strong>Damage Scale:</strong> The damage scale is nearly always 1.0; Marathon changes the fist damage scale internally when the player is running. <em>[This is, strictly speaking, the exact opposite of what happens; Marathon </em>reduces<em> the fist damage when the player is </em>not<em> running. The damage can actually increase slightly above its normal value if the player is moving at faster than normal strafe-running speed (e.g., if carried by a current), but not by much; a variable overflow occurs shortly past that point. -Ed.]</em></li>
								<li><strong>Alien Damage:</strong> If the projectile is fired by an alien, check this box so Marathon can make the aliens easier on Kindergarten and Easy and harder on Major Damage and Total Carnage. <em>[The latter part of this is incorrect &ndash; Alien damage does not increase above Normal. -Ed.]</em></li>
								<li><strong>Flyby Sound:</strong> If a flyby sound is specified, the projectile will play it to any player that the projectile passes close to without hitting. <em>[Strictly speaking, players that the projectile hits may hear the sound as well - the game isn&apos;t that picky. -Ed.]</em></li>
								<li><strong>Rebound Sound:</strong> If a rebound sound is specified and the &quot;rebounds from floor&quot; box is checked, the rebound sound will be played whenever the projectile bounces off the floor.</li>
								<li><strong>Sound Pitch:</strong> To pitch the sound higher, enter a value greater than 1.0. To pitch the sound lower, enter a value less than 1.0 but greater than 0.0.</li>
								<li><strong>Radius:</strong> The radius of the projectile need not be the same as its graphic. A smaller radius will allow the weapon to pass through a smaller opening in the map.</li>
								<li><strong>Area of Effect:</strong> The damage specified above will be applied to every character within the area of effect of the weapon when it detonates.</li>
								<li><strong>Speed:</strong> The speed field determines how quickly the projectile travels across the map. <em>[The speed is in internal units per game tick. Divide by 1,024 to get world units per game tick; multiply the result by 30 to get world units per second. -Ed.]</em></li>
								<li><strong>Maximum Range:</strong> If the projectile reaches its maximum range without impacting a target, it will disappear. If a maximum range of &minus;1 is specified, the projectile will always travel until it hits a target.</li>
								<li><strong>Detonation Effect:</strong> If a detonation effect is specified, the requested effect will be played at the detonation point when the projectile hits a target. To preview effects, open the Effects section of the model.</li>
								<li><strong>Media Detonation Effect:</strong> The media detonation effect is played when the projectile hits some type of media (e.g. water).</li>
								<li><strong>Contrail:</strong> If ticks between contrails (below) is positive, the contrail effect will be created at the specified interval until the maximum number of controls is created.</li>
								<li><strong>Ticks between contrails:</strong> The contrail effect will be created at the interval specified by this field (where 1 tick = 1/30th of a second).</li>
								<li><strong>Maximum contrails:</strong> If this field is not &minus;1, it will be used as the maximum number of contrails created by the projectile.</li>
								<li><strong>Media impact:</strong> This field may specify a type of projectile that will immediately hit the player if the specified projectile is used under media (i.e. when a fusion gun is fired under water).</li>
								<li><strong>Flags:</strong> The flags are used to activate a range of useful and interesting behaviors on each projectile. Some of them require additional numeric fields to be set.
									<ul>
										<li><strong>Guided:</strong> If the guided flag is activated, the projectile will seek out a player if it is fired by a monster. It has no effect for projectiles created by the player.</li>
										<li><strong>Stop when animation loops:</strong> If this box is checked, when the shot&apos;s sequence reaches its loop frame, the effect will end. If this box is not checked the sequence will loop until the shot hits a target.</li>
										<li><strong>Persistent:</strong> If this box is checked, the shot will stop moving and doing damage when it hits a target, but will not disappear until its sequence completes.</li>
										<li><strong>Alien:</strong> Check this box to inform Marathon that a given shot will only be created by aliens rather than by the player or friendly civilians, so that it can be made easier on lower difficulty settings. <em>[This means that it will be slower on lower difficulties and faster on higher difficulties. Contrast this with Alien Damage, which only </em>reduces<em> damage on easier difficulties and does </em>not<em> increase damage on higher ones. -Ed.]</em></li>
										<li><strong>Affected by gravity:</strong> If this box is checked, the shot will drop under the effects of gravity.</li>
										<li><strong>No horizontal error:</strong> If this box is checked, the shot will not suffer any horizontal error when fired (see Error under Weapons, or Alien Attack Definitions).</li>
										<li><strong>No vertical error:</strong> If this box is checked, the shot will not suffer any vertical error when fired (see Error under Weapons, or Alien Attack Definitions).</li>
										<li><strong>Can toggle control panels:</strong> If this box is checked, the shot can toggle control panels and flip switches in the map.</li>
										<li><strong>Positive vertical error:</strong> If this box is checked, the shot will only have positive (i.e. up) vertical error when fired. This is a useful effect when the shot must appear to come out of the top of the firing character.</li>
										<li><strong>Melee projectile:</strong> If this box is checked, Marathon will use the melee projectile impact effect for the shot&apos;s impact results.</li>
										<li><strong>Persistent and virulent:</strong> If this box is checked, the shot will continue until reaching its maximum range or a wall, regardless of how many mobile targets it hits until then. <em>[Note that it will change owner each time it hits a target. -Ed.]</em></li>
										<li><strong>Usually pass transparent side:</strong> If this box is checked, the shot will usually, but not always, pass through a polygon edge containing a partially-transparent texture. If it does not pass the edge, it will impact on the transparent edge. <em>[This is disregarded for any lines marked as &quot;decorative&quot;; all projectiles will always pass partially-transparent textures on either side of such lines, regardless of projectile type or whether the line is marked as &quot;solid&quot;. -Ed.]</em></li>
										<li><strong>Sometimes pass transparent side:</strong> If this box is checked, the shot will sometimes, but not always, pass through a polygon edge containing a partially-transparent texture. If it does not pass the edge, it will impact on the transparent edge. <em>[As with &quot;Usually pass transparent side&quot;, the &quot;decorative&quot; flag overrides this and causes all projectiles to pass such edges. -Ed.]</em></li>
										<li><strong>Doubly affected by gravity:</strong> If this box is checked, the shot will fall at twice the normal gravity rate. Note that the &quot;affected by gravity&quot; box, above, need not be checked.</li>
										<li><strong>Rebounds from floor:</strong> If this box is checked, the shot will rebound from the floor when it hits, unless its forward motion is less than a minimum.</li>
										<li><strong>Penetrates liquids:</strong> If this box is checked, the shot will travel freely under any media type (e.g. water, sewage, etc.).</li>
										<li><strong>Becomes item on detonation:</strong> This box is used internally by Marathon for shots that need to be converted to an item when they finish their motion. You cannot change this behavior. <em>[If this box is checked, the projectile will also not do any damage. -Ed.]</em></li>
										<li><strong>Bleeding projectile:</strong> If this box is checked, the shot will cause the special &quot;ranged impact effect&quot; when it hits a target.</li>
										<li><strong>Horizontal wander:</strong> If this box is checked, the shot will suffer random horizontal error perpendicular to the direction of movement.</li>
										<li><strong>Vertical wander:</strong> If this box is checked, the shot will suffer random vertical error perpendicular to the direction of movement.</li>
										<li><strong>Affected by half gravity:</strong> If this box is checked, the shot will fall in half-gravity maps.</li>
										<li><strong>Penetrates liquid boundary:</strong> <em>(MInf only)</em> If this box is checked, the shot can pass freely through a media layer (e.g. from underwater to above).</li>
									</ul>
								</li>
							</ul>
						<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>	
						<li><h2 id="anvilphysics">Physics</h2>
						The &quot;Physics&quot; section of the physics model stores information about basic constants of the simulation, such as gravity and the player&apos;s top speed.
							<ul>
								<li><strong>Max. forward velocity:</strong> Maximum forward velocity is the maximum speed that the player may move when the forward key is pressed.</li>
								<li><strong>Max. backward velocity:</strong> Max backward velocity is the maximum speed that the player may move when the backward key is pressed.</li>
								<li><strong>Max. perpendicular velocity</strong>: Max perpendicular velocity is the maximum speed for side-step movement by the player.</li>
								<li><strong>Acceleration:</strong> The acceleration field determines how the quickly the player&apos;s speed will increase when moving forward, backwards, or side-stepping.</li>
								<li><strong>Deceleration:</strong> The deceleration field determines how quickly the player will come to a stop when a key is pressed to reverse direction.</li>
								<li><strong>Airborne deceleration:</strong> The airborne deceleration field determines how quickly the player will lose forward-backward velocity while airborne.</li>
								<li><strong>Gravitational acceleration:</strong> The gravitational acceleration field determines how quickly the player will accelerate due to gravity. If it is zero, the player can launch himself by firing weapons down. If it is negative, the player will fly off the ground.</li>
								<li><strong>Climbing acceleration:</strong> The climbing acceleration field determines how quickly the player will gain vertical velocity when climbing stairs.</li>
								<li><strong>Terminal velocity:</strong> Terminal velocity is the maximum speed the player may achieve when in free-fall.</li>
								<li><strong>External deceleration:</strong> The external deceleration field determines how quickly the character comes to a stop when a force is exerted on it by another character or effect.</li>
								<li><strong>Angular acceleration:</strong> The angular acceleration field determines how quickly the player can accelerate his angular velocity and therefore how quickly a turn can be started.</li>
								<li><strong>Angular deceleration:</strong> The angular deceleration field determines how quickly the player can stop a turn.</li>
								<li><strong>Maximum angular velocity:</strong> The maximum angular velocity is the maximum speed at which the player may turn.</li>
								<li><strong>Angular recentering velocity:</strong> The angular recentering velocity determines how quickly the player stops turning.</li>
								<li><strong>Head angular velocity:</strong> The head angular velocity field determines how quickly a look-left or look-right can be made.</li>
								<li><strong>Head angular maximum:</strong> The head angular maximum field is the maximum number of degrees (out of 512) that the player&apos;s head may be turned to the left or right.</li>
								<li><strong>Maximum elevation:</strong> The maximum elevation should always be 42.6666.</li>
								<li><strong>External angular deceleration:</strong> The external angular deceleration determines how quickly the player&apos;s turning will come to a stop if an external force prevents it.</li>
								<li><strong>Step delta:</strong> The step delta determines the distance that the player must travel for a complete viewpoint &quot;bounce&quot; to occur.</li>
								<li><strong>Step amplitude:</strong> The step amplitude determines how much the viewpoint &quot;bounces&quot; during steps.</li>
								<li><strong>Radius:</strong> The radius of the player need not be the same size as the player&apos;s graphic. A smaller radius will allow the player to fit through smaller openings in the map. <em>[No it won&apos;t. This is dependent upon polygon exclusion zones, which are hard-coded at 512 internal units in diameter. -Ed.]</em></li>
								<li><strong>Height:</strong> The height of the player need not be the same size as the player&apos;s graphic. A smaller height will allow the player to fit through smaller windows in the map. <em>[This is correct, however. -Ed.]</em></li>
								<li><strong>Dead height:</strong> The dead height field determines the height of the camera when the player is dead and lying on the ground.</li>
								<li><strong>Camera height:</strong> The camera height determines the normal elevation of the viewpoint that is drawn to the screen.</li>
								<li><strong>Splash height:</strong> The splash height determines the elevation of the viewpoint that is drawn to the screen when the player has died.</li>
								<li><strong>Half camera separation:</strong> The half-camera separation determines the focal length of the perspective projection. Don&apos;t change it unless you know what you&apos;re doing.</li>
							</ul>
						<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>	
						<li><h2 id="anvilweapons">Weapons</h2>
						The &quot;Weapons&quot; section of the physics model stores information about the weapons that players may pick up and use, such as shot type, ammunition, and sounds.
							<ol>
								<li><h3 id="weapondefinition">Weapon Definition</h3>
									<ul>
										<li><strong>Item Type:</strong> This field establishes the connection between a type of item (that can be in the map) and a weapon class.</li>
										<li><strong>Weapon Class:</strong> Melee weapons always use the melee impact effect. Single function weapons fire the main trigger on both keys. Dual function weapons can &quot;charge&quot; to perform their secondary trigger. Two-fisted weapons can be used two at once. Multipurpose weapons have two separate ammo types.</li>
										<li><strong>Appearance:</strong> The constants here determine how the weapon will be drawn when the player is holding it.
											<ul>
												<li><strong>Graphic Collection:</strong> The Graphic Collection must be a number between 0 and 31. It indicates which collection of graphics in the Shapes file will be used to draw this weapon. To preview the graphics collections, open a Shapes file.</li>
												<li><strong>Color Table:</strong> The Color Table must be a number between 0 and the number of tables defined for this collection. It indicates which collection of colors will be used to draw this weapon. To preview the color tables and graphics, open a Shapes file.</li>
												<li><strong>Idle:</strong> The idle sequence ID will be used to draw the weapon whenever it is not firing, reloading, or charging. <em>[Note that idle sequences using more than one frame are bugged, and I do not recommend using them. -Ed.]</em></li>
												<li><strong>Firing:</strong> The firing sequence ID will be used to draw the weapon while it is firing. Note that the length of the firing sequence determines how quickly the weapon can fire.</li>
												<li><strong>Reloading:</strong> The reloading sequence ID will be played whenever the weapon reloads its primary trigger. A multipurpose weapon reloading its secondary trigger may not have a custom graphic sequence.</li>
												<li><strong>Charging:</strong> The charging sequence ID will be played while the weapon is charging. If the charging sequence ID is &minus;1, the normal idle sequence will be used.</li>
												<li><strong>Charged:</strong> The charged sequence ID will be played while the weapon is charged. Note that the &quot;charged weapon sound&quot; from the secondary trigger will also be played whenever the weapon is charged.</li>
												<li><strong>Flash Intensity:</strong> The muzzle flash intensity of the weapon is set by this field. Note that the flash will not appear unless the flash decay time (below) is larger than 0.</li>
											</ul>
										</li>
										<li><strong>Height and Idle</strong>
											<ul>
												<li><strong>Idle Height:</strong> The height at which the weapon idles is determined by this field. It is highly dependent on the size and origin of the idle graphic frames and should not be changed unless you are also changing the idle graphic.</li>
												<li><strong>Bob Amplitude:</strong> The degree of vertical &quot;bob,&quot; or movement with the player&apos;s steps, that the weapon exhibits, is set here.</li>
												<li><strong>Kick Height:</strong> The kick height is added to the idle height of the weapon to find the starting position for the &quot;firing&quot; sequence.</li>
												<li><strong>Reload Height:</strong> The reload height is used to draw the &quot;reloading&quot; sequence. It should not be changed unless you are also changing the reload graphic.</li>
												<li><strong>Idle Width:</strong> The idle width should nearly always be 0.5; it only requires different values for weapons that are not drawn in the bottom-center of the field.</li>
												<li><strong>Horizontal Amplitude:</strong> The horizontal amplitude field should always be 0.0.</li>
											</ul>
										</li>
										<li><strong>Timing:</strong> All of the times given here are measured in ticks (1/30ths of a second).
											<ul>
												<li><strong>Ready time:</strong> The &quot;ready time&quot; is the number of ticks required to bring the weapon from un-ready to ready-to-fire status.</li>
												<li><strong>Await reload:</strong> The &quot;await reload&quot; time is the number of ticks required after the last shot from a clip is fired before the &quot;reloading&quot; sequence is begun. Once the &quot;reloading&quot; sequence has begun the player cannot change weapons.</li>
												<li><strong>Loading:</strong> The &quot;loading&quot; time is the number of ticks required to load a new clip into the weapon (either primary or secondary trigger).</li>
												<li><strong>Finish loading:</strong> The &quot;finish loading&quot; time is the number of ticks required after the clip is loaded before the weapon can be fired again.</li>
												<!--The powerup time is not used.-->
												<li><strong>Flash decay time:</strong> The &quot;flash decay time&quot; is the number of ticks during which the weapon&apos;s muzzle flash fades. Note that the weapon must have a flash intensity, above, for a muzzle flash to appear.</li>
												<!--The powerup type is not used.-->
											</ul>
										</li>
										<li><strong>Flags: </strong> The flags are used to activate a range of useful and interesting behaviors on each weapon. Some of them require additional fields to be set.
											<ul>
												<li><strong>Automatic:</strong> If the automatic flag is set, the weapon will continue to fire as long as the firing key is held down. Note that shots will fire only <del>a</del> <em>[as -Ed.]</em> rapidly as the firing sequence can be played.</li>
												<li><strong>Disappears after use:</strong> If the disappears after use flag is set, the weapon will disappear when it runs out of ammunition.</li>
												<li><strong>Plays instant shell casing sound:</strong> If this flag is set, the weapon will play a shell casing sound at the same time as the firing sound.</li>
												<li><strong>Overloads:</strong> If this flag is set and the weapon&apos;s class is &quot;dual-purpose,&quot; the weapon will explode if it is charged and not fired within a length of time. <em>[That length is apparently one minute. The weapon also does not need to be marked as &quot;Dual-Function&quot; for this to occur. -Ed.]</em></li>
												<li><strong>Random ammo on pickup:</strong> If this flag is set, the weapon will have a random amount of ammunition for its primary trigger when it is picked up. <em>[That amount being based on the primary trigger&apos;s rounds per magazine; it can have anywhere from half the number specified to the number specified. If this and &quot;Triggers Share Ammo&quot; are both checked, the game ignores the secondary trigger&apos;s rounds per magazine when the weapon is picked up; however, if it is ever reloaded, the game appears to select whichever value is larger. -Ed.]</em></li>
												<!--The powerup is temporary flag is not used.-->
												<li><strong>Reloads in one hand:</strong> If this flag is set and the weapon&apos;s class is &quot;two-fisted,&quot; the weapon in the other hand can continue to fire while the first weapon reloads.</li>
												<li><strong>Fires out of phase:</strong> If this flag is set, the weapon can fire two-handed without waiting for the other hand&apos;s animation to complete.</li>
												<li><strong>Fires under liquids:</strong> If this flag is set, the weapon can produce its projectile under any media type (e.g. water). Note that the projectile must have the &quot;penetrates media&quot; flag set in order to do anything.</li>
												<li><strong>Triggers share ammo:</strong> If this flag is set, the primary and secondary triggers use the same ammunition value.</li>
												<li><strong>Angular flapping on 2nd trigger:</strong> If this flag is set, the secondary trigger will introduce an automatic x-axis error to the left or right of the player&apos;s target point.</li>
											</ul>
										</li>
									</ul>

								<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>
								<li><h3 id="triggersettings">Trigger Settings</h3>
									<ul>
										<li><strong>Main/Secondary Triggers:</strong> Whenever a weapon is fired, Marathon will use the information in a trigger record to create the appropriate effect. Note that the secondary trigger information will not be used unless the weapon is a multi-purpose or dual-purpose weapon.</li>
										<li><strong>Projectile:</strong> The type of projectile that will be created when the trigger fires is indicated here. To change projectile statistics, edit the &quot;Shots&quot; section of the model.</li>
										<li><strong>Rounds/magazine:</strong> The number of shots available per clip of ammunition is set here. Note that Marathon may not be able to draw the graphic for remaining ammo if you set this number higher than the default, but that the ammo will still be available.</li>
										<li><strong>Ammo type:</strong> Select the item class that is used to re-arm the trigger here.</li>
										<li><strong>Sounds:</strong> Each trigger may have a custom set of sounds for its behavior set here. Note that unlike many other Marathon behaviors, the graphic sequences are not used to store weapon sounds, as different sounds are needed for each trigger.
											<ul>
												<li><strong>Firing:</strong> This sound will be played whenever the weapon fires.</li>
												<li><strong>Click:</strong> This sound will be played if the weapon is fired without sufficient ammunition.</li>
												<li><strong>Charging:</strong> This sound will be played if the weapon is a dual-purpose weapon during the charging time.</li>
												<li><strong>Shell Casing:</strong> This sound will be played at random intervals when the weapon is fired, if a shell casing graphic is specified.</li>
												<li><strong>Reloading:</strong> This sound will be played when the trigger reloads.</li>
												<li><strong>Charged:</strong> This sound will be played periodically when a dual-purpose weapon is charged. It will be played with increasing frequency and pitch as the charge time increases, until the weapon overloads and explodes <em>[if it is set to do so -Ed.]</em>.</li>
											</ul>
										</li>
										<li><strong>Ticks/round:</strong> If a value other than &minus;1 is entered here, it will be used as the delay between shots when the weapon fires (in ticks of 1/30th of a second). Note that the minimum time for a weapon to fire is always the time for the weapons firing sequence.</li>
										<li><strong>Recovery Ticks:</strong> The recovery time measures the required number of ticks required after a firing animation completes before the weapon can be fired again.</li>
										<li><strong>Charging Ticks:</strong> If a value other than 0 is entered here, it will be used as the required time to charge the trigger before it can be fired. Note that this should ONLY have a value other than 0 if the weapon is a dual-purpose weapon.</li>
										<li><strong>Recoil Magnitude:</strong> If a value other than 0 is entered here, the player will be pushed backwards with a force proportional to the number entered here when the weapon fires (note that a negative value will pull the character forwards).</li>
										<li><strong>Theta Error:</strong> The firing, or &quot;theta&quot; error, is the maximum error applied to the weapon&apos;s aim when it is fired. A higher error will result in a spray of inaccurate fire.</li>
										<li><strong>dx:</strong> The value entered here will be added to the player&apos;s location in the x-axis (left to right) when the weapon fires to find the starting location for the projectile.</li>
										<li><strong>dz:</strong> The value entered here will be added to the player&apos;s location in the z-axis (front to back) when the weapon fires to find the starting location for the projectile.</li>
										<li><strong>Burst Count:</strong> The burst count is the number of projectiles that will be created every time the weapon is fired. Note that there must be enough ammo loaded in the weapon to create the full number of projectiles.</li>
										<li><strong>Shell casing type:</strong> If the weapon should have a shell-casing animation, select one here. Note that the SMG animation is only available in Marathon Infinity.</li>
									</ul>
								</li>
							</ol>
						</li>
					</ol>

				<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>	
				
				<li><h1 id="anvilsounds">Sounds</h1>
				Each Sound may contain up to 5 permutations. You may select the Sound to edit from this menu and then select a permutation from the list box, below.
				<ul>
					<li><strong>8-Bit:</strong> Check this button to listen to and edit the 8-bit (lower-quality, smaller) sounds. <em>[Note that &quot;8-bit&quot; and &quot;16-bit&quot; slots are </em>just names<em>. It&apos;s entirely possible to put 16-bit sounds into both, or 8-bit sounds into both, or a 16-bit sample in the 8-bit slot and an 8-bit sample in the 16-bit slot (why would you do this? Please don&apos;t do this). If a sound is present in only the &quot;8-bit&quot; slot and the player has 16-bit sound sources selected, Aleph One plays the sound in the &quot;8-bit&quot; slot. If both are present, it plays the sound in the &quot;16-bit&quot; slot. If a sound is only present in the &quot;16-bit&quot; slot and the player has 8-bit sound sources selected, the game won&apos;t play a sound. Thus, I </em>strongly recommend always<em> including sounds in the &quot;8-bit&quot; slot. -Ed.]</em></li>
					<li><strong>16-Bit:</strong> Check this button to listen to and edit the 16-bit (high-quality, larger) sounds. <em>[Again, these are </em>just names<em>; see my note directly above for more. -Ed.]</em></li>
					<li><strong>List Box:</strong> This list box displays a list of the permutations assigned to the current sound, above. You may change or insert new sounds by choosing &quot;Insert Permutation&quot; from the Sounds menu.</li>
					<li><strong>Sounds:</strong> This displays the number of permutations stored in the current sound. You may insert new sounds by selecting &quot;Insert Permutation&quot; from the Sounds menu.
					<!--The Sound Code doesn&apos;t seem to do anything.-->
					<li><strong>Volume:</strong> The Volume setting can be used to play the sound more softly, or more loudly, than all other sounds. <em>[This is incorrect. Counter-intuitively, the Volume setting affects how far away the sound is audible, not its in-game volume. -Ed.]</em></li>
					<li><strong>Cannot be restarted:</strong> If the cannot be restarted flag is checked, Marathon will check to see if the sound is already being played before playing it again (i.e. the Bob&apos;s voices).</li>
					<!--Does not self-abort flag-->
					<li><strong>Resists pitch changes:</strong> If the resist pitch changes flag is set, the sound will not be pitch-shifted, even if a monster is trying to pitch change all of its sounds.</li>
					<li><strong>Can&apos;t change pitch:</strong> If the can&apos;t change pitch flag is set, the sound will never change pitch.</li>
					<li><strong>Can&apos;t be obstructed:</strong> If the can&apos;t be obstructed flag is set, the sound will never be obstructed by walls.</li>
					<li><strong>Can&apos;t be media obstructed:</strong> If the can&apos;t be media obstructed flag is set, the sound will never be obstructed by media layers.</li>
					<li><strong>Is Ambient:</strong> The is ambient flag must be set for Marathon to save memory by not loading ambient sounds if they are disabled in the Marathon Preferences.</li>
				</ul>

				<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>

				<li><h1 id="anvilshapes">Shapes</h1>
					<ol>

						<li><h2 id="anvilbitmaps">Bitmaps and Color Tables</h2>
							The Bitmaps fields of a Shape file contain the actual image data for the shapes and the color tables used to draw them. You may insert new shapes or change color tables by changing the Bitmaps records.
							<ul>
								<li><strong>Display:</strong> Choose &quot;Bitmaps&quot; from this menu to view and edit the bitmaps for this collection, or &quot;Color Tables&quot; to view and edit the color tables for the collection.</li>
								<li><strong>Bitmaps:</strong> These are the bitmaps stored in the current collection. Click on one of them and choose Paste from the Edit menu to insert a new graphic, or choose &quot;Import PICT&quot; from the Shape menu to load a PICT graphic.</li>
								<li><strong>Color Table:</strong> Choose the color table you want to view the current bitmaps with from this menu.</li>
							</ul>
						<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>	
						<li><h2 id="anvilsequences">Frames and Sequences</h2>
						The Sequences fields of a Shape file contain the lists of frames that are used to animate objects during the game and draw them from multiple perspectives. They also contain information about synchronized sounds to be played during the sequences.
							<ol>
								<li><h3 id="sequences">Sequences</h3>
									Frames and Views are organized into Sequences, which is a single action taken by a Marathon character, weapon, or effect. You may edit the sequences here.
									<ul>
										<li><strong>Collection:</strong> Select a graphic collection to edit from this menu. Note that not all of the fields visible in the Sequences editor will apply to all collections (especially walls and landscapes).</li>
										<li><strong>Scale Factor:</strong> If a given sequence does not specify a scale factor, the scale factor given here will be used to scale up the graphics for that collection. <em>[In ShapeFusion, the scale factor must be specified, or it will default to 0 and not display the graphic. Moreover, due to a bug, it sometimes shows you the default scale factor for a new frame for which it hasn&apos;t inserted said scale factor. You should always specify this manually when inserting a new frame. -Ed.]</em></li>
										<li><strong>Sequence:</strong> Select a sequence from the list box to edit it.</li>
										<li><strong>Ticks per frame:</strong> Each frame in the sequence will be displayed for one or more ticks (30ths of a second). You may change the number of ticks here.</li>
										<li><strong>Scale factor (this shape):</strong> If this sequence should have a different scale factor from that of the entire collection, enter it here. <em>[In ShapeFusion, as noted above, this should be done manually for every frame, due to a bug that causes it to regard the scale factor of each frame as 0 unless it has been manually specified. (It will display the default scale factor of this collection, but it won&apos;t save the frame that way.) -Ed.]</em></li>
										<li><strong>Transfer Mode:</strong> The Transfer Mode determines how the shape will be drawn to the screen. You may mark a shape as transparent here, for example. Note that to make a monster transparent you should change the transparent flag in the physics model, not the shape mode.</li>
										<li><strong>Transfer mode period:</strong> If the transfer mode requires timing, enter the period (in ticks) for the mode here.</li>
										<li><strong>First frame sound:</strong> If a sound is specified here, it will be played on the first frame of the sequence.</li>
										<li><strong>Key frame sound:</strong> If a sound is specified here, it will be played on a special &quot;key&quot; frame of the sequence. You may set the key frame below.</li>
										<li><strong>Last frame sound:</strong> If a sound is specified here, it will be played on the last frame of the sequence.</li>
										<li><strong># of views:</strong> You may specify 1, 4, 5, or 8 frames for the sequence, depending on whether it should change at 90&deg; (4), 72&deg; (5), or 45&deg; (8) increments, or not at all (1).</li>
										<li><strong>Views in Sequence:</strong> Select a view in the sequence here.</li>
										<li><strong>Frames in View: </strong>Select a frame in the sequence here. Frames will automatically be assigned in consecutive order. <em>[This is not true of ShapeFusion, wherein you can and in fact must assign frames in whatever order you choose. This allows you to reuse one frame as many times as you like, but also requires you to create new frames yourself when you need them. -Ed.]</em></li>
										<li><strong>Frames/view:</strong> Enter the number of frames per view of the sequence here.</li>
										<li><strong>Loop Frame:</strong> If you enter a loop frame index here, the sequence will loop when the index is reached.</li>
										<li><strong>Key Frame:</strong> Enter a key frame index here to mark when the key frame sound should be played, when damage should be applied, and when monsters should attack.</li>
									</ul>
								<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>	
								<li><h3 id="frames">Frames</h3>
									<ul>
										<li>Select a frame from the list here. To create new frames, you must extend the views of a sequence. <em>[This is not true in ShapeFusion, wherein you must create frames independently of sequences. -Ed.]</em></li>
										<li><strong>X-mirror:</strong> If x-mirroring is activated, the frame will be drawn with left and right reversed.</li>
										<li><strong>Y-mirror:</strong> If y-mirroring is activated, the frame will be drawn with top and bottom reversed.</li>
										<li><strong>Keypoint obscured:</strong> (Used only for torsos and legs:) If the keypoint obscured flag is set, the player&apos;s torso will be drawn behind the legs.</li>
										<li><strong>Bitmap Index:</strong> Enter the number of a bitmap here to specify which bitmap the frame should use to draw.</li>
										<li><strong>Min. Light Intensity:</strong> Enter the minimum light intensity required to make a shape visible here. <em>[That is, the frame will always be drawn with at least this light intensity. -Ed.]</em></li>
										<li><strong>X Origin:</strong> Enter the x-coordinate of the shape origin here. The origin point needs to be held constant between frames of a sequence.</li>
										<li><strong>Y Origin:</strong> Enter the y-coordinate of the shape origin here. The origin point needs to be held constant between frames of a sequence.</li>
										<li><strong>X Keypoint:</strong> Enter the x-coordinate of the shape keypoint here. The keypoint is used only for matching player torsos to legs. <em>[Though Bungie seems to have used it to figure out where to flip X-mirrored shapes as well. -Ed.]</em></li>
										<li><strong>Y Keypoint:</strong> Enter the y-coordinate of the shape keypoint here. The keypoint is used only for matching player torsos to legs.</li>
										<!--The world coordinates are visible only for debugging purposes.-->
									</ul>
								</li>
							</ol>
							<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>
						<li><h2 id="clone">Clone into Collection</h2>
							When you &quot;Clone&quot; a collection, all of the bitmaps, color tables, sequences, and frames associated with that collection will be duplicated into the current collection. You may then edit the new collection as you wish. <em>[This functionality does not currently exist in ShapeFusion. Emulating Anvil or using <a href="https://github.com/Hopper262/marathon-utils" target="_blank">Hopper&apos;s Perl scripts</a> are the only ways I&apos;m aware of to accomplish this on a modern operating system, apart from painstakingly copying all the data over and inevitably making errors in the process. -Ed.]</em>
						</li>
					</ol>

				<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p></li>
		</ol>
		</main>
		<footer>
			<h1 id="endnotes">Endnotes</h1>
				
				<table class="light endnotes hyphenate">
					<thead>
						<tr>
							<th class="right"><strong>#</strong></th>
							<th><strong>Note</strong></th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td class="right"><a href="#ftnt_ref01" id="ftnt01" class="noprintlink"><strong>1</strong></a></td>
							<td>Well, almost. I&apos;ve omitted what appear to be &lsquo;dummy balloons&rsquo; referring to features that weren&apos;t implemented in Anvil and don&apos;t appear in ShapeFusion either. Some of these seem to be documentation of M1-specific features. Others may have been documentation for features included in development releases of Anvil that Bungie thought better of including in the finished product; not having been a Bungie employee circa 1996, I couldn&apos;t say for sure.</td>
						</tr>
					</tbody>
				</table>

			<p class="sectionbreak noprint"><a href="#top">Back to top</a> &middot; <a href="#toc">Table of contents</a> &middot; <a href="mapmaking101.html">Mapmaking (basic)</a> &middot; <a href="mapmaking.html">Mapmaking (advanced)</a> &middot; <a href="aboutme.html">Contact me</a> &middot; <a href="index.html">Website index</a></p>

		</footer>
	</body>
</html>
